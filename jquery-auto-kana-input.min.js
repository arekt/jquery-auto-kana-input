(function(){$.fn.extend({auto_kana_input:function(e){var t,n,r,i,s,o,u;return e==null&&(e={}),t=/^[a-zA-Z]$/,n=/^[ぁ-んァ-ヶー]$/,o=null,u=0,s=null,i=this.selector,r=e.target||i+"_kana",this.on("keydown",function(e){var i,a,f,l,c,h,p,d,v,m,g,y;return i=function(e){var t,n;return t=y(),n=t.val(),t.val(n+g(e))},c=function(e){var t;return t=[8,13,32,37,38,39,40],$.inArray(e.which,t)!==-1},l=function(e){return e.match(n)},f=function(){return y().val("")},y=function(){return $(r)},a=function(e){var n,r,i,s,o;i=0;for(r=s=0,o=e.length-1;0<=o?s<=o:s>=o;r=0<=o?++s:--s)n=e.charAt(r),n.match(t)?i+=1:i+=3;return i},g=function(e){return e.replace(/[\u3041-\u3093]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+96)})},h=$(this).val(),d=h.length,v=a(h),p=h.charAt(d-1),v>u&&l(p)&&!c(e)&&(m=h.charAt(d-2),v-u>3&&l(m)?i(m):m.match(/^[っッ]$/)&&i(m),i(p)),d===0&&(f(),v=0),o=h,u=v,s=p})}})}).call(this);
